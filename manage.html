<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>예약 확인/변경 - Ok's House</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/calendar.css">
    <link rel="stylesheet" href="css/privacy.css">
    <link rel="stylesheet" href="css/manage.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1><span class="emoji-normal">⚙️</span> Ok's 러브하우스 예약 확인</h1>
        
        
        <!-- Step 1: 예약자 정보 입력 -->
        <div class="step" id="step1">
            <h3><span class="emoji-normal">🔑</span> 1단계: 예약자 인증</h3>
            <p class="step-description">
                예약 시 입력하신 정보를 동일하게 입력해주세요. 비밀번호는 예약 시 설정하신 4자리 숫자입니다.
            </p>
            <div class="form-group">
                <label for="auth-name">이름:</label>
                <input type="text" id="auth-name" placeholder="예약자 이름을 입력하세요">
            </div>
            <div class="form-group">
                <label for="auth-phone">전화번호:</label>
                <input type="tel" id="auth-phone" placeholder="010-1234-5678">
            </div>
            <div class="form-group">
                <label for="password">비밀번호:</label>
                <input type="password" id="password" placeholder="4자리 숫자 비밀번호">
            </div>
            <div class="button-container">
                <button class="btn btn-back" onclick="location.href='index.html'">이전</button>
                <button class="btn" onclick="nextStep(1)">확인</button>
            </div>
        </div>

        <!-- Step 2: 예약 목록 확인 -->
        <div class="step hidden" id="step2">
            <h3><span class="emoji-normal">📊</span> 2단계: 예약 현황 확인</h3>
            <p class="step-description">
                아래 달력과 예약 목록에서 변경하거나 취소할 예약을 선택해주세요.
            </p>
            
            <!-- 달력 보기 -->
            <div class="calendar-view">
                <div id="calendar-container"></div>
            </div>
            
            <!-- 예약 목록 -->
            <div style="margin-top: 20px;">
                <h4><span class="emoji-normal">📈</span> 내 예약 목록</h4>
                <div id="reservations-list">
                    <!-- 예약 목록이 여기에 동적으로 추가됩니다 -->
                </div>
            </div>
            
            <div class="button-container step2-buttons" style="text-align: center; margin-top: 20px; display: flex; gap: 6px; justify-content: center; flex-wrap: nowrap;">
                <button class="btn btn-back compact-btn" onclick="prevStep(2)">이전</button>
                <button class="btn compact-btn" id="nextBtn2" onclick="startReservationModification()" disabled style="opacity: 0.5; cursor: not-allowed;">예약 변경</button>
                <button class="btn compact-btn" id="cancelBtn2" onclick="cancelSelectedReservation()" disabled style="opacity: 0.5; cursor: not-allowed; background: #e74c3c;">예약 취소</button>
            </div>
        </div>

        <!-- Step 3: 예약 변경/삭제 -->
        <div class="step hidden" id="step3">
            <h3><span class="emoji-normal">⚙️</span> 3단계: 예약 변경 및 취소</h3>
            <p class="step-description">
                선택하신 예약의 날짜를 변경하거나 예약을 완전히 취소할 수 있습니다.
            </p>
            
            <!-- 현재 선택된 예약 정보 -->
            <div class="current-reservation" id="selected-reservation-info">
                선택된 예약 정보가 여기에 표시됩니다
            </div>
            
            <!-- 변경 옵션 -->
            <div class="modify-form" id="modify-form" style="display: none;">
                <h4>새로운 예약 정보</h4>
                
                <!-- 새로운 숙박 기간 선택 -->
                <div class="form-group">
                    <label>새로운 숙박 기간:</label>
                    <div class="duration-buttons">
                        <button class="duration-btn" onclick="selectDuration(1, this)">1박 2일</button>
                        <button class="duration-btn" onclick="selectDuration(2, this)">2박 3일</button>
                        <button class="duration-btn" onclick="selectDuration(3, this)">3박 4일</button>
                        <button class="duration-btn" onclick="selectDuration(4, this)">4박 5일</button>
                        <button class="duration-btn" onclick="selectDuration(5, this)">5박 6일</button>
                        <button class="duration-btn" onclick="selectDuration(6, this)">6박 7일</button>
                        <button class="duration-btn" onclick="selectDuration(7, this)">7박 8일</button>
                        <button class="duration-btn" onclick="selectDuration(8, this)">8박 9일</button>
                        <button class="duration-btn" onclick="selectDuration(9, this)">9박 10일</button>
                        <button class="duration-btn" onclick="selectDuration(10, this)">10박 11일</button>
                    </div>
                </div>
                
                <!-- 새로운 날짜 선택 -->
                <div class="form-group" style="margin-top: 20px;">
                    <label>새로운 예약 날짜:</label>
                    <div class="date-range-display" id="dateRangeDisplay">
                        날짜를 선택해주세요
                    </div>
                    <div id="modify-calendar-container"></div>
                </div>
            </div>
            
            <div class="button-container">
                <button class="btn btn-back" onclick="prevStep(3)">이전</button>
                <button class="btn" onclick="showModifyForm()" id="modify-btn">예약 변경</button>
                <button class="btn btn-delete" onclick="deleteReservation()" id="delete-btn">예약 삭제</button>
                <button class="btn" onclick="completeModification()" id="save-btn" style="display: none;">변경 저장</button>
            </div>
        </div>
    </div>

    <script src="js/common.js"></script>
    <script src="js/calendar.js"></script>
    <script src="js/privacy.js"></script>
    <script>
        // Initialize components
        let stepNavigator, calendar, modifyCalendar, selectedReservation = null;
        
        // Mock reservation data - 실제로는 서버에서 가져올 데이터
        const mockReservations = [
            {
                id: 1,
                name: '홍길동',
                phone: '010-1234-5678',
                startDate: new Date(2025, 7, 10), // 8월 10일
                duration: 2,
                status: 'confirmed'
            },
            {
                id: 2,
                name: '홍길동',
                phone: '010-1234-5678',
                startDate: new Date(2025, 8, 15), // 9월 15일
                duration: 3,
                status: 'confirmed'
            },
            {
                id: 3,
                name: '홍길동',
                phone: '010-1234-5678',
                startDate: new Date(2025, 6, 5), // 7월 5일 (과거)
                duration: 1,
                status: 'completed'
            }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            // Set theme
            ThemeManager.setModifyTheme();
            
            // Initialize input formatters
            InputFormatter.initializeAllFormatters();
            
            // Initialize components
            stepNavigator = new StepNavigator(3);
            
            // Initialize main calendar (read-only for viewing reservations only)
            calendar = new OksCalendar({
                containerId: 'calendar-container',
                primaryColor: '#e67e22',
                rangeBgColor: '#fdeaa7',
                rangeTextColor: '#d35400',
                onDateSelect: null, // Disable date selection
                onMonthChange: handleMonthChange,
                readOnly: true // Make calendar read-only - no date selection allowed
            });

            // Check if we need to go to step 2 (from reservation modification)
            if (window.location.hash === '#step2') {
                // Show step 2 directly - simulate going through step 1
                stepNavigator.hideStep(1);
                stepNavigator.markStepCompleted(1);
                stepNavigator.showStep(2);
                stepNavigator.markStepActive(2);
                
                // Load some mock data for demonstration
                document.getElementById('auth-name').value = '홍길동';
                document.getElementById('auth-phone').value = '010-1234-5678';
                document.getElementById('password').value = '1234';
                
                // Load reservations
                loadUserReservations();
            }
        });

        // Event handlers
        function nextStep(currentStep) {
            const validationFunctions = {
                1: () => {
                    const name = document.getElementById('auth-name').value;
                    const phone = document.getElementById('auth-phone').value;
                    const password = document.getElementById('password').value;
                    
                    if (!FormValidator.validateAuthInfo(name, phone, password)) {
                        return false;
                    }
                    
                    // 입력된 정보로 예약 검색 (실제로는 서버 API 호출)
                    const userReservations = findUserReservations(name, phone, password);
                    if (userReservations.length === 0) {
                        alert('일치하는 예약 정보를 찾을 수 없습니다.');
                        return false;
                    }
                    
                    return true;
                },
                2: () => {
                    if (!selectedReservation) {
                        alert('변경할 예약을 선택해주세요.');
                        return false;
                    }
                    return true;
                }
            };

            const nextStepNum = stepNavigator.nextStep(currentStep, validationFunctions[currentStep]);
            
            if (nextStepNum === 2) {
                loadUserReservations();
            } else if (nextStepNum === 3) {
                showSelectedReservation();
            }
            
            return nextStepNum;
        }

        function prevStep(currentStep) {
            console.log('prevStep called with:', currentStep);
            
            if (currentStep === 3) {
                console.log('Going from step 3 to reservation.html step 2');
                // Going from step 3 (manage.html) back to reservation.html step 2
                hideModifyForm();
                
                // Store reservation data for returning to reservation.html
                const modificationData = {
                    isModification: true,
                    originalReservation: selectedReservation,
                    userInfo: {
                        name: document.getElementById('auth-name').value,
                        phone: document.getElementById('auth-phone').value,
                        password: document.getElementById('password').value
                    },
                    returnToStep: 2  // Return to step 2 (date selection)
                };

                console.log('Storing modificationData:', modificationData);
                sessionStorage.setItem('modificationData', JSON.stringify(modificationData));
                console.log('Redirecting to reservation.html');
                window.location.href = 'reservation.html';
                return;
            }
            
            const prevStepNum = stepNavigator.prevStep(currentStep, (current, prev) => {
                if (current === 2) {
                    selectedReservation = null;
                    document.getElementById('reservations-list').innerHTML = '';
                    // Clear calendar highlights when going back from step 2
                    clearCalendarHighlights();
                }
            });
        }

        function findUserReservations(name, phone, password) {
            // 실제로는 서버 API를 호출하여 사용자 예약을 조회
            const allUserReservations = mockReservations.filter(res => 
                res.name === name && res.phone === phone
            );
            
            // 완료된 예약과 이용 중인 예약은 제외하고 예약 확정 상태만 표시
            return allUserReservations.filter(reservation => {
                const status = ReservationManager.getReservationStatus(
                    reservation.startDate, 
                    reservation.duration
                );
                return status === 'upcoming';
            });
        }

        function loadUserReservations() {
            const name = document.getElementById('auth-name').value;
            const phone = document.getElementById('auth-phone').value;
            const password = document.getElementById('password').value;
            
            const userReservations = findUserReservations(name, phone, password);
            displayReservations(userReservations);
            // Remove automatic highlighting - let calendar stay clean initially
            // highlightReservationsOnCalendar(userReservations);
        }

        function displayReservations(reservations) {
            const listContainer = document.getElementById('reservations-list');
            
            if (reservations.length === 0) {
                listContainer.innerHTML = `
                    <div class="no-reservations">
                        <p style="font-size: var(--text-lg); color: var(--neutral-600); text-align: center; padding: var(--space-8);">
                            현재 변경 가능한 예약이 없습니다.
                        </p>
                        <div style="background: rgba(245, 158, 11, 0.1); padding: var(--space-4); border-radius: var(--radius-lg); margin-top: var(--space-4);">
                            <p style="font-size: var(--text-base); color: var(--neutral-600); margin: 0; line-height: 1.6;">
                                ℹ️ <strong>안내:</strong> 이미 종료된 예약이나 현재 이용 중인 예약은 변경할 수 없어 목록에 표시되지 않습니다.
                            </p>
                        </div>
                    </div>
                `;
                return;
            }
            
            listContainer.innerHTML = reservations.map(reservation => 
                ReservationManager.createReservationCard(reservation)
            ).join('');
            
            // Auto-select the first reservation
            if (reservations.length > 0) {
                setTimeout(() => {
                    selectReservation(reservations[0].id);
                }, 100);
            }
        }

        function highlightReservationsOnCalendar(reservations) {
            setTimeout(() => {
                // 기존 하이라이트 제거
                clearCalendarHighlights();
                
                // 모든 예약을 연한 색으로 표시 (선택되지 않은 상태)
                reservations.forEach(reservation => {
                    for (let i = 0; i < reservation.duration; i++) {
                        const date = new Date(reservation.startDate);
                        date.setDate(reservation.startDate.getDate() + i);
                        highlightOtherReservationDate(date);
                    }
                });
            }, 100);
        }

        function selectReservation(reservationId) {
            // 기존 선택 해제
            document.querySelectorAll('.reservation-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // 새로운 선택 - 이벤트가 있을 때와 없을 때 모두 처리
            const targetCard = document.querySelector(`[data-reservation-id="${reservationId}"]`);
            if (targetCard) {
                targetCard.classList.add('selected');
            }
            
            selectedReservation = mockReservations.find(res => res.id === reservationId);
            
            // 달력을 선택된 예약의 시작날짜 달로 이동하고 예약 기간 표시
            if (selectedReservation && calendar) {
                // 기존 스타일 제거
                clearCalendarHighlights();
                
                // 먼저 달력을 해당 월로 이동
                calendar.navigateToDate(selectedReservation.startDate);
                
                // 달력의 duration을 설정하고 선택된 예약을 표시
                calendar.setDuration(selectedReservation.duration);
                
                // 선택된 예약을 달력에 표시
                setTimeout(() => {
                    calendar.selectDate(selectedReservation.startDate);
                    
                    // 다른 예약들도 하이라이트 (선택된 예약과 구분하기 위해)
                    const name = document.getElementById('auth-name').value;
                    const phone = document.getElementById('auth-phone').value;
                    if (name && phone) {
                        const userReservations = findUserReservations(name, phone, '');
                        highlightOtherReservations(userReservations, selectedReservation.id);
                    }
                }, 200);
            }
            
            // 변경 및 취소 버튼 활성화
            const nextBtn = document.getElementById('nextBtn2');
            const cancelBtn = document.getElementById('cancelBtn2');
            
            nextBtn.disabled = false;
            nextBtn.style.opacity = '1';
            nextBtn.style.cursor = 'pointer';
            
            cancelBtn.disabled = false;
            cancelBtn.style.opacity = '1';
            cancelBtn.style.cursor = 'pointer';
        }

        function highlightOtherReservations(reservations, selectedId) {
            // 선택된 예약이 아닌 다른 예약들을 다른 스타일로 표시
            const otherReservations = reservations.filter(res => res.id !== selectedId);
            
            otherReservations.forEach(reservation => {
                for (let i = 0; i < reservation.duration; i++) {
                    const date = new Date(reservation.startDate);
                    date.setDate(reservation.startDate.getDate() + i);
                    highlightOtherReservationDate(date);
                }
            });
        }

        function highlightOtherReservationDate(date) {
            // 현재 달력에 표시된 월/년과 날짜의 월/년이 일치하는지 확인
            const currentCalendarMonth = calendar.getCurrentMonth();
            
            if (date.getMonth() === currentCalendarMonth.month && 
                date.getFullYear() === currentCalendarMonth.year) {
                
                const dateString = date.getDate().toString();
                const calendarDays = document.querySelectorAll('.calendar-day');
                
                calendarDays.forEach(day => {
                    if (day.textContent === dateString && 
                        !day.classList.contains('other-month') && 
                        !day.classList.contains('selected') && 
                        !day.classList.contains('in-range')) {
                        // 다른 예약은 더 연한 오렌지색으로 표시
                        day.style.backgroundColor = '#fef3e2';
                        day.style.border = '1px solid #f39c12';
                        day.style.color = '#d35400';
                    }
                });
            }
        }

        function clearCalendarHighlights() {
            // 모든 달력 하이라이트 제거
            document.querySelectorAll('.calendar-day').forEach(day => {
                day.classList.remove('reservation-highlight');
                day.style.backgroundColor = '';
                day.style.border = '';
                day.style.color = '';
            });
        }

        function showSelectedReservation() {
            if (!selectedReservation) return;
            
            const endDate = new Date(selectedReservation.startDate);
            endDate.setDate(selectedReservation.startDate.getDate() + selectedReservation.duration);
            
            const infoElement = document.getElementById('selected-reservation-info');
            infoElement.innerHTML = `
                <h4>현재 예약 정보</h4>
                <p><strong>예약자:</strong> ${selectedReservation.name}</p>
                <p><strong>예약 날짜:</strong> ${ReservationManager.formatKoreanDate(selectedReservation.startDate)} ~ ${ReservationManager.formatKoreanDate(endDate)}</p>
                <p><strong>숙박 기간:</strong> ${selectedReservation.duration}박 ${selectedReservation.duration + 1}일</p>
                <p><strong>전화번호:</strong> ${selectedReservation.phone}</p>
            `;
            
            // 폼에 기본값 설정
            document.getElementById('new-name').value = selectedReservation.name;
            document.getElementById('new-phone').value = selectedReservation.phone;
        }

        function showModifyForm() {
            const modifyForm = document.getElementById('modify-form');
            const modifyBtn = document.getElementById('modify-btn');
            const deleteBtn = document.getElementById('delete-btn');
            const saveBtn = document.getElementById('save-btn');
            
            modifyForm.style.display = 'block';
            modifyBtn.style.display = 'none';
            deleteBtn.style.display = 'none';
            saveBtn.style.display = 'inline-block';
            
            // Initialize modify calendar
            if (!modifyCalendar) {
                modifyCalendar = new OksCalendar({
                    containerId: 'modify-calendar-container',
                    dateRangeDisplayId: 'dateRangeDisplay',
                    nextButtonId: 'save-btn',
                    primaryColor: '#e67e22',
                    rangeBgColor: '#fdeaa7',
                    rangeTextColor: '#d35400'
                });
            }
        }

        function hideModifyForm() {
            const modifyForm = document.getElementById('modify-form');
            const modifyBtn = document.getElementById('modify-btn');
            const deleteBtn = document.getElementById('delete-btn');
            const saveBtn = document.getElementById('save-btn');
            
            modifyForm.style.display = 'none';
            modifyBtn.style.display = 'inline-block';
            deleteBtn.style.display = 'inline-block';
            saveBtn.style.display = 'none';
        }

        function selectDuration(days, button) {
            // Duration button selection logic
            document.querySelectorAll('.duration-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            button.classList.add('selected');
            
            if (modifyCalendar) {
                modifyCalendar.setDuration(days);
            }
        }

        function deleteReservation() {
            if (!selectedReservation) return;
            
            const confirmDelete = confirm(`정말로 이 예약을 삭제하시겠습니까?\n\n예약 날짜: ${ReservationManager.formatKoreanDate(selectedReservation.startDate)}\n예약자: ${selectedReservation.name}`);
            
            if (confirmDelete) {
                // 실제로는 서버 API 호출
                alert('예약이 삭제되었습니다.');
                location.href = 'index.html';
            }
        }

        function completeModification() {
            if (!modifyCalendar || !modifyCalendar.getSelectedDate()) {
                FeedbackManager.showAlert('새로운 예약 날짜를 선택해주세요.', 'warning');
                return false;
            }
            
            const selectedDurationButton = document.querySelector('.duration-btn.selected');
            if (!selectedDurationButton) {
                FeedbackManager.showAlert('새로운 숙박 기간을 선택해주세요.', 'warning');
                return false;
            }
            
            // 이미 인증된 사용자 정보 사용
            const userName = document.getElementById('auth-name').value;
            const userPhone = document.getElementById('auth-phone').value;
            
            // 변경된 예약 정보로 성공 메시지 표시
            const selectedDate = modifyCalendar.getSelectedDate();
            const duration = modifyCalendar.getDuration();
            const endDate = new Date(selectedDate);
            endDate.setDate(selectedDate.getDate() + duration);
            
            FeedbackManager.showSuccess(
                '🎉 예약 변경이 완료되었습니다!',
                `${userName}님의 예약이 성공적으로 변경되었습니다. 새로운 예약 날짜: ${ReservationManager.formatKoreanDate(selectedDate)} ~ ${ReservationManager.formatKoreanDate(endDate)}<br>(${duration}박 ${duration + 1}일)`,
                () => {
                    window.location.href = 'index.html';
                }
            );
        }
        
        function showModificationCompletionScreen() {
            const selectedDate = modifyCalendar.getSelectedDate();
            const duration = modifyCalendar.getDuration();
            const endDate = new Date(selectedDate);
            endDate.setDate(selectedDate.getDate() + duration);
            
            const newName = document.getElementById('new-name').value;
            const newPhone = document.getElementById('new-phone').value;
            
            // 컨테이너 내용을 완료 화면으로 교체
            document.querySelector('.container').innerHTML = `
                <div style="text-align: center; padding: 40px 20px;">
                    <div style="font-size: 4rem; margin-bottom: 20px;">🎉</div>
                    <h1 style="color: var(--success); font-size: 2.5rem; margin-bottom: 20px; font-weight: 700;">
                        예약 변경 완료!
                    </h1>
                    <div style="background: rgba(4, 120, 87, 0.1); border: 2px solid var(--success); border-radius: 20px; padding: 30px; margin: 30px 0; text-align: left;">
                        <h3 style="color: var(--success); margin-top: 0; margin-bottom: 20px; text-align: center;">
                            📅 변경된 예약 정보
                        </h3>
                        <div style="font-size: 1.1rem; line-height: 1.8; color: var(--neutral-800);">
                            <p><strong>📍 예약자:</strong> ${newName}</p>
                            <p><strong>📞 전화번호:</strong> ${newPhone}</p>
                            <p><strong>🗓️ 예약 날짜:</strong> ${ReservationManager.formatKoreanDate(selectedDate)} ~ ${ReservationManager.formatKoreanDate(endDate)}</p>
                            <p><strong>🏠 숙박 기간:</strong> ${duration}박 ${duration + 1}일</p>
                        </div>
                    </div>
                    <div style="background: rgba(245, 158, 11, 0.1); border: 1px solid rgba(245, 158, 11, 0.3); border-radius: 16px; padding: 20px; margin: 20px 0;">
                        <p style="margin: 0; color: var(--warning); font-weight: 600;">
                            🏡 Ok's 러브하우스에서 편안한 시간 보내시길 바랍니다!
                        </p>
                    </div>
                    <button class="btn" onclick="location.href='index.html'" style="
                        font-size: 1.2rem;
                        padding: 16px 32px;
                        margin-top: 30px;
                        background: linear-gradient(135deg, var(--success) 0%, #047857 100%);
                        border: none;
                        box-shadow: 0 8px 25px rgba(4, 120, 87, 0.3);
                    ">
                        🏠 메인으로 돌아가기
                    </button>
                </div>
            `;
        }

        function handleCalendarDateSelect(date, duration) {
            // Calendar date selection handler
            console.log('Calendar date selected:', date, duration);
        }

        function handleMonthChange(month, year) {
            // Month change handler
            console.log('Month changed to:', year, month + 1);
            
            // Only re-highlight if a reservation is currently selected
            if (selectedReservation) {
                // Re-highlight the selected reservation and other reservations
                const name = document.getElementById('auth-name').value;
                const phone = document.getElementById('auth-phone').value;
                if (name && phone) {
                    const userReservations = findUserReservations(name, phone, '');
                    setTimeout(() => {
                        // Clear and re-apply highlights for selected reservation
                        clearCalendarHighlights();
                        calendar.selectDate(selectedReservation.startDate);
                        highlightOtherReservations(userReservations, selectedReservation.id);
                    }, 100);
                }
            }
        }

        function startReservationModification() {
            if (!selectedReservation) {
                FeedbackManager.showAlert('변경할 예약을 선택해주세요.', 'warning');
                return;
            }

            // Store reservation data and user info for the reservation page
            const modificationData = {
                isModification: true,
                originalReservation: selectedReservation,
                userInfo: {
                    name: document.getElementById('auth-name').value,
                    phone: document.getElementById('auth-phone').value,
                    password: document.getElementById('password').value
                }
            };

            // Store in sessionStorage for the reservation page to use
            sessionStorage.setItem('modificationData', JSON.stringify(modificationData));

            // Redirect to reservation page
            window.location.href = 'reservation.html';
        }

        function cancelSelectedReservation() {
            if (!selectedReservation) {
                FeedbackManager.showAlert('취소할 예약을 선택해주세요.', 'warning');
                return;
            }

            const endDate = new Date(selectedReservation.startDate);
            endDate.setDate(selectedReservation.startDate.getDate() + selectedReservation.duration);

            // 사용자 확인 팝업
            FeedbackManager.showConfirm(
                `이 예약을 취소하시겠습니까?`,
                `예약자: ${selectedReservation.name}<br>체크인: ${ReservationManager.formatKoreanDate(selectedReservation.startDate)}<br>체크아웃: ${ReservationManager.formatKoreanDate(endDate)}<br>기간: ${selectedReservation.duration}박 ${selectedReservation.duration + 1}일`,
                () => {
                    // 확인을 선택한 경우 - 취소 성공 메시지 표시
                    FeedbackManager.showSuccess(
                        '👌🏻 예약 취소 완료!',
                        `${selectedReservation.name}님의 예약이 성공적으로 취소되었습니다.`,
                        () => {
                            window.location.href = 'index.html';
                        }
                    );
                },
                () => {
                    // 취소를 선택한 경우 - 아무것도 하지 않음
                    console.log('예약 취소 취소됨');
                }
            );
        }
        
    </script>
</body>
</html>